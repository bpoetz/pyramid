// Generated by CoffeeScript 1.6.1

  $(function() {

    get_page = function(event) {
      var wikiword;
      wikiword = $(this).html();
      return $.get(wikiword).done(replace_html);
    };
    edit_page = function(event) {
      var wikiword;
      wikiword = $('input.name').val();
      console.log(wikiword, $('textarea').val());
      return $.ajax({
        type: 'POST',
        url: wikiword,
        data: {data: $('textarea').val(),
                },
        dataType: 'json',
      }).done(replace_html);
    };
    replace_html = function(data) {
      console.log(data);

      if (data.error != null) {
        $('#error').html(data.error);
        $('.data').html('This wiki does not exist.  Please create it.');
        $('.name').html(data.name);
        $('.wikiwords li').remove();
        $('.updated').html('')
      }
      if (data.page != null) {
        $('.name').html(data.page.name);
        $('.data').html(data.page.data);

        for (_i = 0, _len = data.wikiwords.length; _i < _len; _i++) {
          word = _ref[_i];
          $('#wikiwords').append('<li><a href=#{word}>#{word}</a></li>');
        }
        $('#updated').html(data.page.updated);
      }
    };
    $('a.wikiword').on('click', get_page);
    $('button').on('click', edit_page);
  });
